{#if label}
  <label>
    {label}
    <select bind:this={selectElement}
            bind:value
            {...$$restProps}
            on:change={onChange}
            on:blur
            on:focus>
      <slot />
    </select>
  </label>
{:else}
  <select bind:this={selectElement}
          bind:value
          {...$$restProps}
          on:change={onChange}
          on:blur
          on:focus>
    <slot />
  </select>
{/if}

<script >import { createEventDispatcher } from 'svelte';
export let label = '';
export let value = '';
let selectElement;
const dispatch = createEventDispatcher();
function onChange({ target }) {
    dispatch('change', target.value);
}
$: if (selectElement && value !== undefined) {
    const options = selectElement.querySelectorAll('option');
    const opt = Array.from(options).find((opt) => {
        return opt.value == value;
    });
    if (opt)
        opt.selected = true;
}
</script>
