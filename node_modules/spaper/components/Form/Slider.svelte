<label class:block
       class:disabled
       {...$$restProps}>
  {#if $$slots.default}
    <slot />
  {:else}
    {label}
  {/if}
  <input type="range"
         bind:this={rangeEl}
         bind:value
         class={classes}
         {min} {max} {step} />
  {#if !hideValue}
    <output>
      {#if $$slots.output}
        <slot name="output" />
      {:else}
        {outputValue}
        {#if percentage}%{/if}
      {/if}
    </output>
  {/if}
</label>

<script >import { onMount } from 'svelte';
;
import { computeClasses } from '../../utils';
export let label = '';
export let min = 0;
export let max = 100;
export let step = 1;
export let block = false;
export let hideValue = false;
export let value = null;
export let background = 'secondary';
export let percentage = false;
export let disabled = false;
let rangeEl;
let outputValue;
onMount(() => {
    outputValue = rangeEl.value;
});
let classes;
$: classes = `range-${background} ${computeClasses('input', { block })}`;
// need to react to programmatic change to `value` as well as slider variations
$: if (value !== null) {
    outputValue = String(value);
}
$: if (percentage) {
    outputValue = String(Math.round(Number(outputValue) / Number(max) * 100));
}
</script>

<style >label.block {
  width: 100%;
}
label.disabled {
  pointer-events: none;
}

input {
  margin-bottom: 0.35rem;
}

input[type=range].range-primary::-webkit-slider-runnable-track {
  background: var(--primary);
}

input[type=range].range-primary::-moz-range-track {
  background: var(--primary);
}

input[type=range].range-primary::-ms-track {
  background: var(--primary);
}

input[type=range].range-secondary::-webkit-slider-runnable-track {
  background: var(--secondary);
}

input[type=range].range-secondary::-moz-range-track {
  background: var(--secondary);
}

input[type=range].range-secondary::-ms-track {
  background: var(--secondary);
}

input[type=range].range-success::-webkit-slider-runnable-track {
  background: var(--success);
}

input[type=range].range-success::-moz-range-track {
  background: var(--success);
}

input[type=range].range-success::-ms-track {
  background: var(--success);
}

input[type=range].range-warning::-webkit-slider-runnable-track {
  background: var(--warning);
}

input[type=range].range-warning::-moz-range-track {
  background: var(--warning);
}

input[type=range].range-warning::-ms-track {
  background: var(--warning);
}

input[type=range].range-danger::-webkit-slider-runnable-track {
  background: var(--danger);
}

input[type=range].range-danger::-moz-range-track {
  background: var(--danger);
}

input[type=range].range-danger::-ms-track {
  background: var(--danger);
}</style>
