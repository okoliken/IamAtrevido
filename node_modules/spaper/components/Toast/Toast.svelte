{#if active}
  <div class={classes}
       bind:this={toastElement}
       on:mouseenter={pause}
       on:mouseleave={dismiss}
       in:fly={{ y: position.includes('top') ? -100 : 100 }}
       out:fade={{ duration: TRANSITION_OUT_DURATION }}
       role="alert">
    {@html message}
    {#if dismissible||indefinite}
      <CloseButton ariaLabel={closeAriaLabel}
                   on:click={close} />
    {/if}
  </div>
{/if}

<script >import { onMount } from 'svelte';
import { fly, fade } from 'svelte/transition';
;
;
import { computeClasses } from '../../utils';
import ToastContainer, { containerClass } from './ToastContainer.svelte';
import CloseButton from '../CloseButton.svelte';
export let message;
export let type = 'primary';
export let duration = 2000;
export let position = 'top-right';
export let pauseOnHover = false;
export let dismissible = false;
export let indefinite = false;
export let closeAriaLabel = 'close';
export let onClose = null;
const TRANSITION_OUT_DURATION = 300;
let active = true;
let toastElement;
let timeoutId;
$: containerSelector = `.${containerClass}.${position}`;
$: classes = `alert margin-small shadow ${computeClasses('alert', { type })}`;
onMount(() => {
    insert();
    if (!indefinite) {
        timeoutId = window.setTimeout(close, duration);
    }
    if (timeoutId) {
        return () => clearTimeout(timeoutId);
    }
});
function pause() {
    if (!pauseOnHover || indefinite)
        return;
    clearTimeout(timeoutId);
}
function dismiss() {
    if (!pauseOnHover || indefinite)
        return;
    close();
}
function close() {
    active = false;
    removeContainer();
    onClose === null || onClose === void 0 ? void 0 : onClose();
}
function getContainer() {
    return document.querySelector(containerSelector);
}
function setupContainer() {
    new ToastContainer({
        target: document.body,
        props: { position },
    });
    return getContainer();
}
function insert() {
    const container = getContainer() || setupContainer();
    container.insertAdjacentElement('afterbegin', toastElement);
}
function removeContainer() {
    const container = getContainer();
    setTimeout(() => {
        if (container.children.length === 1) {
            container.remove();
        }
    }, TRANSITION_OUT_DURATION);
}
</script>

<style>
div {
  width: 250px;
}
</style>
